!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(t.Mars||(t.Mars={})).React=e()}}(function(){return function e(t,n,r){function o(u,i){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!i&&s)return s(u,!0);if(a)return a(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[u]={exports:{}};t[u][0].call(f.exports,function(e){var n=t[u][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[u].exports}for(var a="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var s=e("react"),c=r(s),f=function(e){function t(e,n){o(this,t);var r=a(this,Object.getPrototypeOf(t).call(this,e,n));return r.state={result:{}},r.query=e.component.getQuery(e.variables),r.query.on("update",r._handleDataChanges.bind(r)),r._executeQuery(),r}return u(t,e),i(t,[{key:"_executeQuery",value:function(){var e=this;this._resolved=!1,this.query.execute().then(function(){e._resolved=!0})}},{key:"_handleDataChanges",value:function(e){this._resolved&&this.setState({result:e})}},{key:"componentWillUnmount",value:function(){this.query.stop()}},{key:"componentWillReceiveProps",value:function(e){this.query.updateVariables(e)}},{key:"render",value:function(){var e=this.props.component;return this._resolved?c["default"].createElement(e,this.state.result):null}}]),t}(c["default"].Component);n["default"]=f},{react:void 0}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("fast.js/map"),c=r(s),f=e("marsdb"),l=e("invariant"),p=r(l),d=e("./utils"),v=r(d);(function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?new Map:arguments[0];o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this));return n.variables=e,n.emitCleanup=n.emitCleanup.bind(n),n.setMaxListeners(1/0),n}return u(t,e),i(t,[{key:"addCleanupListener",value:function(e){var t=this;return this.on("cleanup",e),function(){return t.removeListener("cleanup",e)}}},{key:"emitCleanup",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];this.emit("cleanup",e)}},{key:"createChildContext",value:function(){var e=new t(this.variables),n=this.addCleanupListener(function(t){e.emitCleanup(!1),!t&&n()});return e}},{key:"withinContext",value:function(e){var n=t.getCurrentContext();t.__currentContext=this;try{return e()}finally{t.__currentContext=n}}},{key:"getVariables",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=this.variables.get(e);r||(r={},this.variables.set(e,r));var o={};for(var a in t)void 0!==n[a]?((0,p["default"])(v["default"]._isProperty(n[a]),"You can pass to a mapping only parent variables"),o[a]=n[a]):void 0!==r[a]?o[a]=r[a]:(r[a]=v["default"]._createProperty(t[a]),o[a]=r[a]);return o}},{key:"trackVariablesChange",value:function(e,t,n){var r=this,o=function(){r.emitCleanup(),e.promise&&e.promise.stop();var o=r.withinContext(function(){return n(t)});if(v["default"]._isCursor(o))r.trackCursorChange(e,o),e.emitChange();else{if(v["default"]._isProperty(o))throw new Error("Next value can't be a property");e(o)}},a=(0,c["default"])(t,function(e){return e.addChangeListener(o)}),u=this.addCleanupListener(function(e){e||(a.forEach(function(e){return e()}),u())})}},{key:"trackCursorChange",value:function(e,t){var n=this;e.removeCursorTracker&&e.removeCursorTracker();var r=function(t){Array.isArray(t)&&(t=(0,c["default"])(t,function(e){return v["default"]._createPropertyWithContext(e,n)})),e(t)};t.on("cursorChanged",this.emitCleanup),e.promise=t.observe(r),e.removeCursorTracker=function(){t.removeListener("cursorChanged",n.emitCleanup),e.promise.stop()};var o=this.addCleanupListener(function(t){t||(e.removeCursorTracker(),o())})}}],[{key:"getCurrentContext",value:function(){return t.__currentContext}}]),t})(f.EventEmitter)},{"./utils":5,"fast.js/map":14,invariant:19,marsdb:void 0}],3:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var s=e("fast.js/object/keys"),c=r(s),f=e("fast.js/forEach"),l=r(f),p=e("fast.js/map"),d=r(p),v=e("marsdb"),h=e("marsdb/dist/CursorObservable"),y=function(e){function t(e,n,r){o(this,t);var u=a(this,Object.getPrototypeOf(t).call(this));return u.containerClass=r,u.fragmentNames=(0,c["default"])(e),u.initVarsOverride=n,u.context=new ExecutionContext,u.variables=u.context.getVariables(r,n),u._handleDataChanges=(0,h.debounce)(u._handleDataChanges.bind(u),10,5),u}return u(t,e),i(t,[{key:"execute",value:function(){var e=this;return this._execution||(this.result={},this.context.withinContext(function(){(0,l["default"])(e.fragmentNames,function(t){e.result[t]=e.containerClass.getFragment(t)})}),this._stoppers=(0,d["default"])(this.fragmentNames,function(t){return e.result[t].addChangeListener(e._handleDataChanges)}),this._execution=Promise.resolve(),this._handleDataChanges()),this._execution}},{key:"stop",value:function(){var e=this;invariant(this._execution,"stop(...): query is not executing"),this._execution.then(function(){(0,l["default"])(e._stoppers,function(e){return e()}),e.removeAllListeners(),e.context.emitCleanup(),e._execution=null})}},{key:"updateVariables",value:function(e){var t=this;invariant(this._execution,"updateVariables(...): query is not executing"),this._execution.then(function(){(0,l["default"])(e,function(e,n){t.variables[n]&&t.variables[n](e)})})}},{key:"_handleDataChanges",value:function(){var e=this,t=(0,d["default"])(this.fragmentNames,function(t){return e.result[t].promise}),n=Promise.all(t).then(function(){e._execution===n&&e.emit("update",e.result)});this._execution=n}}]),t}(v.EventEmitter);n["default"]=y},{"fast.js/forEach":9,"fast.js/map":14,"fast.js/object/keys":17,marsdb:void 0,"marsdb/dist/CursorObservable":void 0}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function s(e,t){var n=t.fragments,r=t.initialVariables,s=t.versions;(0,C["default"])("object"===("undefined"==typeof n?"undefined":i(n))&&(0,v["default"])(n).length>0,"createContainer(...): fragments must be non-empty object");var l=(0,v["default"])(n),d=function(e){var t="";return(0,p["default"])(l,function(n){t+=s&&s[n]&&e[n]?s[n](e[n]()):e[n]&&e[n].version}),t},h=function(t){function s(e,t){o(this,s);var n=a(this,Object.getPrototypeOf(s).call(this,e,t));return n.prevHash=d(e),n}return u(s,t),f(s,[{key:"shouldComponentUpdate",value:function(e){var t=d(e),n=t!==this.prevHash;return this.prevHash=t,n}},{key:"render",value:function(){var t=this.props[l[0]].context.variables.get(s);return m["default"].createElement(e,c({},this.props,{variables:t}))}}],[{key:"getFragment",value:function(e,t){var o=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],a=arguments[3];a=a||x["default"].getCurrentContext(),(0,C["default"])(a,"getFragment(...): must be invoked within some context");var u=a.createChildContext(),c=n[e],f=(0,y["default"])({},r,o),l=u.getVariables(s,f,t);return(0,C["default"])("function"==typeof c||"object"===("undefined"==typeof c?"undefined":i(c)),"getFragment(...): a fragment must be a function or an object"),"object"===("undefined"==typeof c?"undefined":i(c))?k["default"]._getJoinFunction(s,c,l,u):k["default"]._getFragmentValue(s,c,l,u)}},{key:"getQuery",value:function(e){return new w["default"](n,e,s)}}]),s}(m["default"].Component);return h}var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=s;var l=e("fast.js/forEach"),p=r(l),d=e("fast.js/object/keys"),v=r(d),h=e("fast.js/object/assign"),y=r(h),b=e("react"),m=r(b),g=e("invariant"),C=r(g),_=e("./ExecutionContext"),x=r(_),j=e("./QueryExecutor"),w=r(j),O=e("./utils"),k=r(O)},{"./ExecutionContext":2,"./QueryExecutor":3,"./utils":5,"fast.js/forEach":9,"fast.js/object/assign":15,"fast.js/object/keys":17,invariant:19,react:void 0}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function a(e){return"function"==typeof e&&!!e.isProperty}function u(e){return e instanceof b["default"]}function i(e,t,n,r){var o=r.withinContext(function(){return t(n)}),i=void 0;return a(o)?i=o:(i=f(null,r),u(o)?r.trackCursorChange(i,o):i(o),r.trackVariablesChange(i,n,t)),i}function s(e,t,n,r){return function(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],u=arguments.length<=1||void 0===arguments[1]?g:arguments[1];return"object"===("undefined"==typeof a?"undefined":o(a))?(0,p["default"])(t,function(t,o){var s=(0,v["default"])(t,null,a),c=i(e,s,n,r);return a[o]=c,c.promise||!function(){var e=c.addChangeListener(u),t=r.addCleanupListener(function(n){n||(t(),e())})}(),c.promise}):void 0}}function c(e){var t=new h.EventEmitter;t.setMaxListeners(1/0);var n=e,r=function o(){return arguments.length>0&&(n=arguments[0],o.emitChange()),n};return r.emitChange=function(){r.version=++m,t.emit("change")},r.addChangeListener=function(e){return t.on("change",e),function(){t.removeListener("change",e)}},r.version=++m,r.isProperty=!0,r}function f(e,t){var n=c(e);return n.context=t,n}Object.defineProperty(n,"__esModule",{value:!0}),n._isProperty=a,n._isCursor=u,n._getFragmentValue=i,n._getJoinFunction=s,n._createProperty=c,n._createPropertyWithContext=f;var l=e("fast.js/map"),p=r(l),d=e("fast.js/function/bind"),v=r(d),h=e("marsdb"),y=e("marsdb/dist/CursorObservable"),b=r(y),m=0,g=function(){}},{"fast.js/function/bind":12,"fast.js/map":14,marsdb:void 0,"marsdb/dist/CursorObservable":void 0}],6:[function(e,t,n){var r=e("./dist/createContainer")["default"],o=e("./dist/DataManagerContainer")["default"];t.exports={__esModule:!0,createContainer:r,DataManagerContainer:o}},{"./dist/DataManagerContainer":1,"./dist/createContainer":4}],7:[function(e,t,n){"use strict";var r=e("../function/bindInternal3");t.exports=function(e,t,n){var o,a=e.length,u=void 0!==n?r(t,n):t;for(o=0;a>o;o++)u(e[o],o,e)}},{"../function/bindInternal3":13}],8:[function(e,t,n){"use strict";var r=e("../function/bindInternal3");t.exports=function(e,t,n){var o,a=e.length,u=new Array(a),i=void 0!==n?r(t,n):t;for(o=0;a>o;o++)u[o]=i(e[o],o,e);return u}},{"../function/bindInternal3":13}],9:[function(e,t,n){"use strict";var r=e("./array/forEach"),o=e("./object/forEach");t.exports=function(e,t,n){return e instanceof Array?r(e,t,n):o(e,t,n)}},{"./array/forEach":7,"./object/forEach":16}],10:[function(e,t,n){"use strict";t.exports=function(e,t){switch(t.length){case 0:return e();case 1:return e(t[0]);case 2:return e(t[0],t[1]);case 3:return e(t[0],t[1],t[2]);case 4:return e(t[0],t[1],t[2],t[3]);case 5:return e(t[0],t[1],t[2],t[3],t[4]);case 6:return e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);default:return e.apply(void 0,t)}}},{}],11:[function(e,t,n){"use strict";t.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2]);case 4:return e.call(t,n[0],n[1],n[2],n[3]);case 5:return e.call(t,n[0],n[1],n[2],n[3],n[4]);case 6:return e.call(t,n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return e.call(t,n[0],n[1],n[2],n[3],n[4],n[5],n[6]);case 8:return e.call(t,n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);default:return e.apply(t,n)}}},{}],12:[function(e,t,n){"use strict";var r=e("./applyWithContext"),o=e("./applyNoContext");t.exports=function(e,t){var n,a=arguments.length-2;if(a>0){n=new Array(a);for(var u=0;a>u;u++)n[u]=arguments[u+2];return void 0!==t?function(){var o,u=arguments.length,i=new Array(a+u);for(o=0;a>o;o++)i[o]=n[o];for(o=0;u>o;o++)i[a+o]=arguments[o];return r(e,t,i)}:function(){var t,r=arguments.length,u=new Array(a+r);for(t=0;a>t;t++)u[t]=n[t];for(t=0;r>t;t++)u[a+t]=arguments[t];return o(e,u)}}return void 0!==t?function(){return r(e,t,arguments)}:function(){return o(e,arguments)}}},{"./applyNoContext":10,"./applyWithContext":11}],13:[function(e,t,n){"use strict";t.exports=function(e,t){return function(n,r,o){return e.call(t,n,r,o)}}},{}],14:[function(e,t,n){"use strict";var r=e("./array/map"),o=e("./object/map");t.exports=function(e,t,n){return e instanceof Array?r(e,t,n):o(e,t,n)}},{"./array/map":8,"./object/map":18}],15:[function(e,t,n){"use strict";t.exports=function(e){var t,n,r,o,a,u,i=arguments.length;for(n=1;i>n;n++)for(t=arguments[n],o=Object.keys(t),r=o.length,u=0;r>u;u++)a=o[u],e[a]=t[a];return e}},{}],16:[function(e,t,n){"use strict";var r=e("../function/bindInternal3");t.exports=function(e,t,n){var o,a,u=Object.keys(e),i=u.length,s=void 0!==n?r(t,n):t;for(a=0;i>a;a++)o=u[a],s(e[o],o,e)}},{"../function/bindInternal3":13}],17:[function(e,t,n){"use strict";t.exports="function"==typeof Object.keys?Object.keys:function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],18:[function(e,t,n){"use strict";var r=e("../function/bindInternal3");t.exports=function(e,t,n){var o,a,u=Object.keys(e),i=u.length,s={},c=void 0!==n?r(t,n):t;for(o=0;i>o;o++)a=u[o],s[a]=c(e[a],a,e);return s}},{"../function/bindInternal3":13}],19:[function(e,t,n){"use strict";var r=function(e,t,n,r,o,a,u,i){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,a,u,i],f=0;s=new Error(t.replace(/%s/g,function(){return c[f++]})),s.name="Invariant Violation"}throw s.framesToPop=1,s}};t.exports=r},{}]},{},[6])(6)});